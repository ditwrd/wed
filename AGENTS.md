# Agent Configuration for Wed Codebase

## Build/Lint/Test Commands

- Build: `go build -o ./tmp/main main.go`
- Run with hot reload: `air` (uses .air.toml config)
- Generate templ files: `templ generate`
- Build CSS: `pnpm tailwindcss -m -i internal/web/tailwind.css -o internal/web/static/styles.css`
- Lint: `golangci-lint run` (if installed)
- Format: `go fmt ./...`
- Run all tests: `go test ./...`
- Run single test: `go test -run TestName ./path/to/package`
- Run test with coverage: `go test -cover ./path/to/package`
- Run test with verbose output: `go test -v ./path/to/package`

## Code Style Guidelines

- Use templ for UI components with Tailwind CSS
- Follow Go standard naming conventions (camelCase for variables, PascalCase for exported functions)
- Use structured logging with zap
- Dependency injection with uber/fx
- Components use Props structs for configuration
- Tailwind classes merged with twmerge to handle conflicts
- Use utils.TwMerge for combining Tailwind classes
- Error handling with explicit error returns
- Database queries with sqlbuilder
- HTMX for hypertext interaction
- Alpinejs for client interaction
- Use explicit error handling with early returns
- Use context for request-scoped values and cancellation
- Follow the existing project structure for new files
- Write tests for new functionality when applicable
- Use form tags with struct tags for validation (required, oneof, etc.)
- Use viper for configuration management
- Use cobra for CLI command structure
- Use echo for HTTP server framework
- Use fx for dependency injection lifecycle management
- Group related functionality in separate subpackages under internal/
- Use interface{} sparingly and prefer concrete types
- Use constants for magic numbers and string literals
- Use meaningful variable names that convey purpose
- Keep functions short and focused on single responsibility
- Use godoc comments for exported functions and types

## Project Structure

```
.
├── cmd/                 # CLI commands (cobra)
│   ├── migrate.go       # Database migration command
│   ├── root.go          # Root CLI command
│   └── serve.go         # Server start command
├── internal/            # Application internal packages
│   ├── db/              # Database layer
│   │   ├── migrations/  # Database migrations
│   │   ├── db.go        # Database connection
│   │   └── fx.go        # FX module definition
│   │   └── rsvp.go      # RSVP data access
│   ├── server/          # HTTP server layer
│   │   ├── fx.go        # FX module definition
│   │   ├── server.go    # Echo server setup
│   │   ├── middleware.go # HTTP middleware
│   │   ├── module.go    # Server module definition
│   │   ├── api/         # API handlers
│   │   │   └── handler.go # API endpoint handlers
│   │   ├── auth/        # Authentication handlers
│   │   │   ├── handler.go # Auth endpoint handlers
│   │   │   └── jwt.go   # JWT utilities
│   │   ├── hypertext/   # HTMX handlers
│   │   │   ├── handler.go # HTMX endpoint handlers
│   │   │   └── router.go # HTMX routes
│   │   ├── page/        # Page handlers
│   │   │   ├── handler.go # Page endpoint handlers
│   │   │   ├── render.go # Page rendering
│   │   │   └── router.go # Page routes
│   └── web/             # Web frontend
│       ├── component/   # UI components (autogenerated except nav/scroll)
│       ├── layout/      # Page layouts
│       ├── modules/     # Reusable UI modules
│       ├── page/        # Page templates
│       ├── static/      # Static assets (JS, CSS)
│       └── utils/       # Utility functions
└── web/                 # Legacy web directory (will be removed)
```

## Autogenerated Files Policy

- `internal/web/component/*` - Autogenerated UI components (except nav and scroll)
- `internal/web/utils/templui.go` - Autogenerated utility file
- Do not edit autogenerated components except nav, scroll and pines
- Do not edit internal/web/utils/templui.go under any circumstances
- Regenerate components with `templ generate` after modifying .templ files

## Project Planning

- Before doing any task like adding feature, fixing or refactoring, plan everything beforehand in a todo\_<task_name>.md
- While doing the task, update the todo.md if it's done
- If you find any additional things you want to do, ask before adding it to the todo list
- Create focused commits with clear messages
- Keep pull requests small and focused on single changes
- Update documentation when making API or functionality changes

## Key Dependencies

- echo/v4: Web framework
- a-h/templ: Template engine
- uber/fx: Dependency injection
- spf13/cobra: CLI framework
- spf13/viper: Configuration
- modernc.org/sqlite: Database
- huandu/go-sqlbuilder: SQL query builder
- zap: Logging
